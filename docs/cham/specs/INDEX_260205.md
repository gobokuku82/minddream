# Enterprise Agent System - Specification Index
**Version**: 2.0 | **Date**: 2026-02-05 | **Status**: Draft

## Document Overview

기업용 AI 에이전트 시스템의 기술 명세서 모음입니다.

---

## Core Documents

| Document | Description | Priority |
|----------|-------------|----------|
| [ARCHITECTURE_260205.md](ARCHITECTURE_260205.md) | 전체 시스템 아키텍처 | **High** |
| [DATA_MODELS_260205.md](DATA_MODELS_260205.md) | Pydantic 데이터 모델 정의 | **Critical** |
| [DB_SCHEMA_260205.md](DB_SCHEMA_260205.md) | 데이터베이스 스키마 설계 | **Critical** |
| [LAYER_SPEC_260205.md](LAYER_SPEC_260205.md) | 4-Layer 아키텍처 상세 명세 | **High** |
| [TODO_SYSTEM_260205.md](TODO_SYSTEM_260205.md) | Todo 시스템 & HITL 명세 | **High** |
| [API_SPEC_260205.md](API_SPEC_260205.md) | REST API & WebSocket 명세 | **High** |
| [TOOL_REGISTRY_260205.md](TOOL_REGISTRY_260205.md) | 도구 정의 및 등록 시스템 | **Medium** |

---

## System Architecture Summary

```
┌─────────────────────────────────────────────────────────────────┐
│                    4-Layer Agent Architecture                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────┐      ┌─────────────┐      ┌─────────────┐     │
│  │  COGNITIVE  │  →   │  PLANNING   │  →   │  EXECUTION  │     │
│  │   Layer     │      │   Layer     │      │   Layer     │     │
│  │             │      │             │      │             │     │
│  │ • Intent    │      │ • Todo Gen  │      │ • Supervisor│     │
│  │ • Entity    │      │ • Dependency│      │ • Executors │     │
│  │ • Dialogue  │      │ • Resource  │      │ • Cache     │     │
│  └─────────────┘      └──────┬──────┘      └─────────────┘     │
│                              │                                   │
│                        ◆ HITL Gate ◆                            │
│                              │                                   │
│                              ▼                                   │
│                       ┌─────────────┐                           │
│                       │  RESPONSE   │                           │
│                       │   Layer     │                           │
│                       │             │                           │
│                       │ • Aggregate │                           │
│                       │ • Summarize │                           │
│                       │ • Generate  │                           │
│                       └─────────────┘                           │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Key Features

### 1. Todo-Centric Execution
- 모든 작업을 TodoItem으로 모델링
- 의존성 기반 실행 순서
- 상태 추적 및 버전 관리

### 2. Human-in-the-Loop (HITL)
- Plan Review: 플랜 검토 및 수정
- Approval Gate: 중요 작업 승인
- Input Request: 추가 정보 요청
- Pause/Resume: 실행 제어

### 3. Real-time Streaming
- WebSocket 기반 상태 업데이트
- Single Todo per Cycle 실행
- 진행상황 실시간 표시

### 4. Declarative Tool System
- YAML 기반 도구 정의
- 자동 발견 및 등록
- Hot Reload 지원

---

## Data Model Hierarchy

```
AgentState
├── user_input
├── language
├── intent (IntentClassificationResult)
│   ├── domain
│   ├── category
│   └── entities[]
├── plan (Plan)
│   ├── todos[] (TodoItem)
│   │   ├── title
│   │   ├── status
│   │   ├── tool_name
│   │   ├── depends_on[]
│   │   └── result_data
│   ├── versions[]
│   └── changes[]
├── execution_graph (ExecutionGraph)
├── resource_plan (ResourcePlan)
├── ml_result
├── biz_result
├── response
└── hitl_mode
```

---

## Database Tables

| Table | Description |
|-------|-------------|
| `sessions` | 세션 관리 |
| `plans` | 플랜 저장 |
| `plan_versions` | 플랜 버전 히스토리 |
| `todos` | Todo 아이템 |
| `execution_results` | 실행 결과 |
| `hitl_events` | HITL 이벤트 로그 |
| `tools` | 도구 레지스트리 |
| `users` | 사용자 관리 |
| `organizations` | 조직 관리 |

---

## API Endpoints Summary

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/agent/run` | 동기 실행 |
| `POST` | `/api/agent/run-async` | 비동기 실행 |
| `GET` | `/api/agent/status/{id}` | 상태 조회 |
| `POST` | `/api/agent/stop/{id}` | 실행 중지 |
| `GET` | `/api/plan/{id}` | 플랜 조회 |
| `POST` | `/api/plan/{id}/approve` | 플랜 승인 |
| `PATCH` | `/api/plan/{id}` | 플랜 수정 |
| `POST` | `/api/plan/{id}/nl-edit` | 자연어 수정 |
| `WS` | `/ws/{session_id}` | 실시간 업데이트 |

---

## Tool Categories

| Category | Layer | Tools |
|----------|-------|-------|
| **Data** | data | collector, preprocessor, trends |
| **Analysis** | ml | sentiment, keyword, hashtag, competitor |
| **Content** | biz | report, video, ad_creative |
| **Business** | biz | sales, inventory, dashboard |

---

## Implementation Roadmap

### Phase 1: Core Infrastructure ✓
- [x] 4-Layer Architecture
- [x] LangGraph Integration
- [x] Basic Todo System
- [x] WebSocket Streaming

### Phase 2: HITL & Persistence (Current)
- [ ] Full HITL Implementation
- [ ] PostgreSQL Schema Migration
- [ ] Plan Version Management
- [ ] Approval Workflow

### Phase 3: Advanced Features
- [ ] Natural Language Plan Editing
- [ ] Resource Optimization
- [ ] Cost Estimation
- [ ] Analytics Dashboard

### Phase 4: Enterprise Features
- [ ] Multi-tenant Support
- [ ] RBAC (Role-Based Access Control)
- [ ] Audit Logging
- [ ] SLA Monitoring

---

## Quick Links

- **Models**: [DATA_MODELS_260205.md](DATA_MODELS_260205.md)
- **Database**: [DB_SCHEMA_260205.md](DB_SCHEMA_260205.md)
- **API**: [API_SPEC_260205.md](API_SPEC_260205.md)
- **Tools**: [TOOL_REGISTRY_260205.md](TOOL_REGISTRY_260205.md)
